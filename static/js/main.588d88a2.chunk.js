(this["webpackJsonpsimbirsoft-workshop-admin"]=this["webpackJsonpsimbirsoft-workshop-admin"]||[]).push([[0],{101:function(e,t,r){},225:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),s=r(40),c=r.n(s),i=r(52),o=(r(101),r(31)),u=r(6),p=r(19),l=r(42),d=r(96),h=r(18),b=function(){return Object(o.b)()},f=o.c,j=r(2),m=r.n(j),g=r(7),x=r(22),O="tokensDetails",_=function(e){return btoa("".concat(function(e){for(var t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=r.length,a=0;a<e;a+=1)t+=r.charAt(Math.floor(Math.random()*n));return t}(e),":").concat("4cbcea96de"))},v=function(){var e=localStorage.getItem(O);if(!e)return null;var t=JSON.parse(e),r=t.expireDate,n=t.authToken,a=t.refreshToken;return r<(new Date).getTime()?null:{authToken:n,refreshToken:a}},k=r(4),L=r(5),w=r(54),N=r.n(w),y=function(){function e(){Object(k.a)(this,e),this.accessTokenInterceptor=void 0,this.instance=void 0,this.accessTokenInterceptor=null,this.instance=N.a.create({baseURL:"https://api-factory.simbirsoft1.com/api/",headers:{"X-Api-Factory-Application-Id":"5e25c641099b810b946c5d5b"}})}return Object(L.a)(e,[{key:"login",value:function(){var e=Object(g.a)(m.a.mark((function e(t,r){var n,a,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,a=t.password,e.next=3,this.instance.post("auth/login",{username:n,password:a},{headers:{Authorization:"Basic ".concat(r)}});case 3:return s=e.sent,e.abrupt("return",s.data);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=Object(g.a)(m.a.mark((function e(t,r){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.instance.post("auth/refresh",{refresh_token:t},{headers:{Authorization:"Basic ".concat(r)}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"check",value:function(){var e=Object(g.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.instance.get("auth/check");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(g.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.instance.post("auth/logout");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"injectAccessToken",value:function(e){this.accessTokenInterceptor=this.instance.interceptors.request.use((function(t){return Object(p.a)(Object(p.a)({},t),{},{headers:Object(p.a)(Object(p.a)({},t.headers),{},{Authorization:"Bearer ".concat(e)})})}))}},{key:"ejectAccessToken",value:function(){this.accessTokenInterceptor&&N.a.interceptors.request.eject(this.accessTokenInterceptor)}}]),e}(),W=new y,T=Object(x.b)("auth/login",function(){var e=Object(g.a)(m.a.mark((function e(t,r){var n,a,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.dispatch,e.prev=1,a=_(15),e.next=5,W.login(t,a);case 5:s=e.sent,D(s,n,a),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),401===e.t0.response.status&&n(A());case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,r){return e.apply(this,arguments)}}()),S=Object(x.b)("auth/tryAutoLogin",function(){var e=Object(g.a)(m.a.mark((function e(t,r){var n,a,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.dispatch,!(a=v())){e.next=7;break}return e.next=5,W.refresh(a.refreshToken,a.authToken);case 5:s=e.sent,D(s,n,a.authToken);case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),I=Object(x.b)("auth/logout",Object(g.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.logout();case 2:W.ejectAccessToken(),localStorage.removeItem(O);case 4:case"end":return e.stop()}}),e)})))),E=Object(x.c)({name:"auth",initialState:{isLoggedIn:!1,isLoginError:!1,isSubmitting:!1},reducers:{setIsLoggedIn:function(e,t){e.isLoggedIn=t.payload},loginSuccess:function(e){e.isLoggedIn=!0,e.isLoginError=!1},loginFail:function(e){e.isLoginError=!0}},extraReducers:function(e){e.addCase(T.pending,(function(e){e.isSubmitting=!0})).addCase(T.fulfilled,(function(e){e.isSubmitting=!1})).addCase(S.pending,(function(e){e.isSubmitting=!0})).addCase(S.fulfilled,(function(e){e.isSubmitting=!1})).addCase(I.fulfilled,(function(e){e.isLoggedIn=!1}))}}),F=E.actions,M=F.loginSuccess,A=F.loginFail,C=function(e){return e.auth.isLoggedIn},J=function(e){return e.auth.isLoginError},q=function(e){return e.auth.isSubmitting},D=function(e,t,r){W.injectAccessToken(e.access_token),function(e,t,r){var n={expireDate:(new Date).getTime()+1e3*e,refreshToken:t,authToken:r};localStorage.setItem(O,JSON.stringify(n))}(e.expires_in,e.refresh_token,r),t(M())},P=E.reducer,z=r(55),B=r.n(z),R=r(1),G=function(){return Object(R.jsx)("div",{className:B.a.loaderWrapper,children:Object(R.jsx)("div",{className:B.a.loader})})},V=r(8),H=r.n(V),Q=function(){var e,t,r=b(),n=f(J),a=f(q),s=l.a({username:l.b().max(15,"\u041d\u0435 \u0431\u043e\u043b\u0435\u0435 15 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432").required("\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u043a \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044e"),password:l.b().max(15,"\u041d\u0435 \u0431\u043e\u043b\u0435\u0435 15 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432").required("\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u043a \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044e")}),c=Object(h.d)({resolver:Object(d.a)(s)}),i=c.register,o=c.handleSubmit,u=c.formState.errors,j=o((function(e){return r(T(e))}));return Object(R.jsx)("div",{className:H.a.formWrapper,children:a?Object(R.jsx)(G,{}):Object(R.jsxs)("form",{className:H.a.form,onSubmit:j,children:[Object(R.jsx)("div",{className:H.a.title,children:"\u0412\u0445\u043e\u0434"}),n&&Object(R.jsx)("div",{className:H.a.formErrorMessageWrapper,children:Object(R.jsx)("span",{className:H.a.errorMessage,children:"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043b\u043e\u0433\u0438\u043d \u0438/\u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c"})}),Object(R.jsxs)("div",{className:H.a.inputsContainer,children:[Object(R.jsx)("label",{className:H.a.label,htmlFor:"username",children:"\u041f\u043e\u0447\u0442\u0430"}),Object(R.jsx)("span",{className:H.a.inputErrorMessageWrapper,children:Object(R.jsx)("span",{className:H.a.errorMessage,children:null===(e=u.username)||void 0===e?void 0:e.message})}),Object(R.jsx)("input",Object(p.a)({className:H.a.input,id:"username",type:"text"},i("username",{required:!0,maxLength:15}))),Object(R.jsx)("label",{className:H.a.label,htmlFor:"password",children:"\u041f\u0430\u0440\u043e\u043b\u044c"}),Object(R.jsx)("span",{className:H.a.inputErrorMessageWrapper,children:Object(R.jsx)("span",{className:H.a.errorMessage,children:null===(t=u.password)||void 0===t?void 0:t.message})}),Object(R.jsx)("input",Object(p.a)({className:H.a.input,id:"password",type:"password"},i("password",{required:!0})))]}),Object(R.jsxs)("div",{className:H.a.controls,children:[Object(R.jsx)("div",{className:H.a.register,children:"\u0417\u0430\u043f\u0440\u043e\u0441\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f"}),Object(R.jsx)("button",{className:H.a.submit,type:"submit",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})})},U=r(25),X=r.n(U),K=r.p+"static/media/Logo.bc4f3ee8.svg";var Y=function(){return Object(R.jsx)("div",{className:X.a.pageWrapper,children:Object(R.jsxs)("div",{className:X.a.contentContainer,children:[Object(R.jsxs)("div",{className:X.a.logo,children:[Object(R.jsx)("img",{src:K,alt:"logo"}),Object(R.jsx)("div",{className:X.a.title,children:"Need for car"})]}),Object(R.jsx)("div",{className:X.a.formWrapper,children:Object(R.jsx)(Q,{})})]})})},Z=r(94),$=r.n(Z),ee=function(){var e=f(C),t=b();return Object(n.useEffect)((function(){t(S())}),[]),Object(R.jsx)("div",{className:$.a.appWrapper,children:Object(R.jsxs)(u.d,{children:[Object(R.jsx)(u.b,{path:"/admin",children:e?Object(R.jsxs)("div",{children:["u are authorized!!!",Object(R.jsx)("button",{onClick:function(){t(I())},children:"\u0432\u044b\u0439\u0442\u0438"})]}):Object(R.jsx)(u.a,{to:"/login"})}),Object(R.jsx)(u.b,{path:"/login",children:e?Object(R.jsx)(u.a,{to:"/admin"}):Object(R.jsx)(Y,{})}),Object(R.jsx)(u.b,{path:"/",children:Object(R.jsx)(u.a,{to:"/admin"})})]})})},te=Object(x.a)({reducer:{auth:P}});c.a.render(Object(R.jsx)(a.a.StrictMode,{children:Object(R.jsx)(i.a,{children:Object(R.jsx)(o.a,{store:te,children:Object(R.jsx)(ee,{})})})}),document.getElementById("root"))},25:function(e,t,r){e.exports={pageWrapper:"LoginPage_pageWrapper__1pEGk",contentContainer:"LoginPage_contentContainer__fUA4f",logo:"LoginPage_logo__3YeLq",title:"LoginPage_title__27XRo",formWrapper:"LoginPage_formWrapper__2hO3T"}},55:function(e,t,r){e.exports={loaderWrapper:"Loader_loaderWrapper__1CJbf",loader:"Loader_loader__15EID",load8:"Loader_load8__bq-Qr"}},8:function(e,t,r){e.exports={formWrapper:"LoginForm_formWrapper__1af8a",title:"LoginForm_title__yaymJ",formErrorMessageWrapper:"LoginForm_formErrorMessageWrapper__1nKiG",inputErrorMessageWrapper:"LoginForm_inputErrorMessageWrapper__33LwE",errorMessage:"LoginForm_errorMessage__14JJ4",inputsContainer:"LoginForm_inputsContainer__ep_np",label:"LoginForm_label__1zwRH",input:"LoginForm_input__HsgdV",controls:"LoginForm_controls__d2JVQ",register:"LoginForm_register__VSf50",submit:"LoginForm_submit__3cDG5"}},94:function(e,t,r){e.exports={appWrapper:"App_appWrapper__1B5rP"}}},[[225,1,2]]]);
//# sourceMappingURL=main.588d88a2.chunk.js.map