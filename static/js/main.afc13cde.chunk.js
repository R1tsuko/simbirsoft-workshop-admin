(this["webpackJsonpsimbirsoft-workshop-admin"]=this["webpackJsonpsimbirsoft-workshop-admin"]||[]).push([[0],{13:function(e,t,n){e.exports={pageWrapper:"LoginPage_pageWrapper__1pEGk",contentContainer:"LoginPage_contentContainer__fUA4f",logo:"LoginPage_logo__3YeLq",title:"LoginPage_title__27XRo",formWrapper:"LoginPage_formWrapper__2hO3T"}},23:function(e,t,n){e.exports={loaderWrapper:"Loader_loaderWrapper__1CJbf",loader:"Loader_loader__15EID",load8:"Loader_load8__bq-Qr"}},38:function(e,t,n){e.exports={appWrapper:"App_appWrapper__1B5rP"}},45:function(e,t,n){},72:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(18),c=n.n(s),i=n(21),o=(n(45),n(15)),u=n(3),l=n(10),p=n(40),d=function(){return Object(o.b)()},f=o.c,h=n(2),b=n.n(h),j=n(4),m=n(11),g="tokensDetails",O=function(e){return btoa("".concat(function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=n.length,a=0;a<e;a+=1)t+=n.charAt(Math.floor(Math.random()*r));return t}(e),":").concat("4cbcea96de"))},x=function(){var e=localStorage.getItem(g);if(!e)return null;var t=JSON.parse(e),n=t.expireDate,r=t.authToken,a=t.refreshToken;return n<(new Date).getTime()?null:{authToken:r,refreshToken:a}},_=n(36),v=n(37),k=n(22),L=n.n(k),w=function(){function e(){Object(_.a)(this,e),this.accessTokenInterceptor=void 0,this.instance=void 0,this.accessTokenInterceptor=null,this.instance=L.a.create({baseURL:"https://api-factory.simbirsoft1.com/api/",headers:{"X-Api-Factory-Application-Id":"5e25c641099b810b946c5d5b"}})}return Object(v.a)(e,[{key:"login",value:function(){var e=Object(j.a)(b.a.mark((function e(t,n){var r,a,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.username,a=t.password,e.next=3,this.instance.post("auth/login",{username:r,password:a},{headers:{Authorization:"Basic ".concat(n)}});case 3:return s=e.sent,e.abrupt("return",s.data);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=Object(j.a)(b.a.mark((function e(t,n){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.instance.post("auth/refresh",{refresh_token:t},{headers:{Authorization:"Basic ".concat(n)}});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"check",value:function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.instance.get("auth/check");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.instance.post("auth/logout");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"injectAccessToken",value:function(e){this.accessTokenInterceptor=this.instance.interceptors.request.use((function(t){return Object(l.a)(Object(l.a)({},t),{},{headers:Object(l.a)(Object(l.a)({},t.headers),{},{Authorization:"Bearer ".concat(e)})})}))}},{key:"ejectAccessToken",value:function(){this.accessTokenInterceptor&&L.a.interceptors.request.eject(this.accessTokenInterceptor)}}]),e}(),y=new w,N=Object(m.b)("auth/login",function(){var e=Object(j.a)(b.a.mark((function e(t,n){var r,a,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.dispatch,e.prev=1,a=O(15),e.next=5,y.login(t,a);case 5:s=e.sent,J(s,r,a),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),401===e.t0.response.status&&r(A());case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}()),T=Object(m.b)("auth/tryAutoLogin",function(){var e=Object(j.a)(b.a.mark((function e(t,n){var r,a,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.dispatch,!(a=x())){e.next=7;break}return e.next=5,y.refresh(a.refreshToken,a.authToken);case 5:s=e.sent,J(s,r,a.authToken);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),S=Object(m.b)("auth/logout",Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.logout();case 2:y.ejectAccessToken(),localStorage.removeItem(g);case 4:case"end":return e.stop()}}),e)})))),I=Object(m.c)({name:"auth",initialState:{isLoggedIn:!1,isLoginError:!1,isSubmitting:!1},reducers:{setIsLoggedIn:function(e,t){e.isLoggedIn=t.payload},loginSuccess:function(e){e.isLoggedIn=!0,e.isLoginError=!1},loginFail:function(e){e.isLoginError=!0}},extraReducers:function(e){e.addCase(N.pending,(function(e){e.isSubmitting=!0})).addCase(N.fulfilled,(function(e){e.isSubmitting=!1})).addCase(T.pending,(function(e){e.isSubmitting=!0})).addCase(T.fulfilled,(function(e){e.isSubmitting=!1})).addCase(S.fulfilled,(function(e){e.isLoggedIn=!1}))}}),W=I.actions,F=W.loginSuccess,A=W.loginFail,C=function(e){return e.auth.isLoggedIn},E=function(e){return e.auth.isLoginError},D=function(e){return e.auth.isSubmitting},J=function(e,t,n){y.injectAccessToken(e.access_token),function(e,t,n){var r={expireDate:(new Date).getTime()+1e3*e,refreshToken:t,authToken:n};localStorage.setItem(g,JSON.stringify(r))}(e.expires_in,e.refresh_token,n),t(F())},z=I.reducer,M=n(23),P=n.n(M),B=n(1),R=function(){return Object(B.jsx)("div",{className:P.a.loaderWrapper,children:Object(B.jsx)("div",{className:P.a.loader})})},q=n(8),V=n.n(q),G=function(){var e=d(),t=f(E),n=f(D),r=Object(p.a)(),a=r.register,s=(0,r.handleSubmit)((function(t){return e(N(t))}));return Object(B.jsx)("div",{className:V.a.formWrapper,children:n?Object(B.jsx)(R,{}):Object(B.jsxs)("form",{className:V.a.form,onSubmit:s,children:[Object(B.jsx)("div",{className:V.a.title,children:"\u0412\u0445\u043e\u0434"}),t?Object(B.jsx)("div",{className:V.a.formErrorMessage,children:"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043b\u043e\u0433\u0438\u043d \u0438/\u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c"}):null,Object(B.jsxs)("div",{className:V.a.inputsContainer,children:[Object(B.jsx)("label",{className:V.a.label,htmlFor:"username",children:"\u041f\u043e\u0447\u0442\u0430"}),Object(B.jsx)("input",Object(l.a)({className:V.a.input,id:"username",type:"text"},a("username"))),Object(B.jsx)("label",{className:V.a.label,htmlFor:"password",children:"\u041f\u0430\u0440\u043e\u043b\u044c"}),Object(B.jsx)("input",Object(l.a)({className:V.a.input,id:"password",type:"password"},a("password")))]}),Object(B.jsxs)("div",{className:V.a.controls,children:[Object(B.jsx)("div",{className:V.a.register,children:"\u0417\u0430\u043f\u0440\u043e\u0441\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f"}),Object(B.jsx)("button",{className:V.a.submit,type:"submit",children:"Submit"})]})]})})},H=n(13),Q=n.n(H),U=n.p+"static/media/Logo.bc4f3ee8.svg";var X=function(){return Object(B.jsx)("div",{className:Q.a.pageWrapper,children:Object(B.jsxs)("div",{className:Q.a.contentContainer,children:[Object(B.jsxs)("div",{className:Q.a.logo,children:[Object(B.jsx)("img",{src:U,alt:"logo"}),Object(B.jsx)("div",{className:Q.a.title,children:"Need for car"})]}),Object(B.jsx)("div",{className:Q.a.formWrapper,children:Object(B.jsx)(G,{})})]})})},Y=n(38),K=n.n(Y),Z=function(){var e=f(C),t=d();return Object(r.useEffect)((function(){t(T())}),[]),Object(B.jsx)("div",{className:K.a.appWrapper,children:Object(B.jsxs)(u.d,{children:[Object(B.jsx)(u.b,{path:"/admin",children:e?Object(B.jsxs)("div",{children:["u are authorized!!!",Object(B.jsx)("button",{onClick:function(){t(S())},children:"\u0432\u044b\u0439\u0442\u0438"})]}):Object(B.jsx)(u.a,{to:"/login"})}),Object(B.jsx)(u.b,{path:"/login",children:e?Object(B.jsx)(u.a,{to:"/admin"}):Object(B.jsx)(X,{})}),Object(B.jsx)(u.b,{path:"/",children:Object(B.jsx)(u.a,{to:"/admin"})})]})})},$=Object(m.a)({reducer:{auth:z}});c.a.render(Object(B.jsx)(a.a.StrictMode,{children:Object(B.jsx)(i.a,{children:Object(B.jsx)(o.a,{store:$,children:Object(B.jsx)(Z,{})})})}),document.getElementById("root"))},8:function(e,t,n){e.exports={formWrapper:"LoginForm_formWrapper__1af8a",title:"LoginForm_title__yaymJ",formErrorMessage:"LoginForm_formErrorMessage__31Rz-",inputsContainer:"LoginForm_inputsContainer__ep_np",label:"LoginForm_label__1zwRH",input:"LoginForm_input__HsgdV",controls:"LoginForm_controls__d2JVQ",register:"LoginForm_register__VSf50",submit:"LoginForm_submit__3cDG5"}}},[[72,1,2]]]);
//# sourceMappingURL=main.afc13cde.chunk.js.map